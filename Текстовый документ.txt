Понял — проблема с DNS. Ниже — исчерпывающая пошаговая инструкция по диагностике и исправлению «не удаётся получить DNS-запись домена / настроено неправильно». Сделайте по списку — это не требует доступа к серверу, только к вашему аккаунту у регистратора/провайдера DNS и к компьютеру (для проверок).

---

# 1. Быстрая проверка — какие команды выполнить (в терминале/командной строке)

Скопируйте и выполните команды — они дадут точные данные, которые помогут найти проблему.

**Linux / macOS (Terminal)**:

```bash
# 1) узнать NS (какие авторитативные серверы у домена)
dig NS yourdomain.tld +short

# 2) запрос конкретной записи у авторитативного NS (замените ns.example на NS из предыдущей команды)
dig @ns.example yourdomain.tld A +short

# 3) посмотреть, что видят публичные резолверы (Google)
dig @8.8.8.8 yourdomain.tld A +short

# 4) трассировка делегирования (показывает, на каком уровне что не делегировано)
dig +trace yourdomain.tld

# 5) получить SOA (корневая информация о зоне)
dig SOA yourdomain.tld +short
```

**Windows (cmd.exe / PowerShell)**:

```powershell
nslookup -type=ns yourdomain.tld
nslookup -type=a yourdomain.tld 8.8.8.8
nslookup -type=soa yourdomain.tld
```

---

# 2. Что смотреть в результатах и как интерпретировать

1. **NS-записи (делегирование)**

   * `dig NS yourdomain.tld +short` должен вернуть список имён серверов (например `ns1.provider.com`, `ns2.provider.com`).
   * Если NS отсутствуют — домен не делегирован → нужно назначить NS в панели регистратора.

2. **Авторитативные ответы**

   * Выполните `dig @<one_of_NS> yourdomain.tld A +short`.

     * Если авторитативный NS не отвечает или возвращает `SERVFAIL`/`REFUSED`, значит зона не настроена у провайдера DNS.
     * Если авторитативный NS возвращает правильный IP — проблема может быть в делегировании/кешах.

3. **Публичный резолвер (8.8.8.8)**

   * `dig @8.8.8.8 yourdomain.tld A +short`. Если тут пусто, а авторитативный NS имеет запись — вероятна проблема с делегированием у регистратора или DNSSEC/ошибка синхронизации.

4. **TRACE**

   * `dig +trace` показывает делегирование от корня до ваших NS. Если на каком-то шаге trace «падает» — смотрите именно этот шаг (чаще всего: NS не назначены у регистратора или указаны неправильно).

5. **SOA**

   * `dig SOA` покажет серийник зоны и контактную информацию — полезно для подтверждения, что зона существует.

6. **Ошибки, на которые обратить внимание**

   * `NXDOMAIN` — домен не найден (возможно, домен не зарегистрирован/истёк).
   * `SERVFAIL` — сервер авторитетный, но не может обработать запрос (возможная ошибка конфигурации / DNSSEC).
   * `REFUSED` — сервер отказывает (зона существует, но сервер настроен отказывать внешним запросам).
   * Пустой ответ у публичных резолверов, но не пустой у авторитативного NS → проблема с делегированием.

---

# 3. Частые причины и способы исправить

### A. NS не назначены в панели регистратора

* Что сделать: зайдите в аккаунт у регистратора (где куплен домен) → раздел «Nameservers»/«DNS» → укажите NS вашего DNS-хостинга (например `ns1.provider`, `ns2.provider`).
* Если вы используете DNS хостера (Cloudflare, Hetzner, DNSMadeEasy и т.д.) — используйте именно те NS, которые они выдали.

### B. Зона не создана у провайдера DNS

* Симптом: NS у регистратора указаны, но `dig @ns` возвращает `NXDOMAIN` или нет записей.
* Исправление: войдите в панель DNS-провайдера и создайте зону для домена; добавьте нужные записи (A, CNAME, MX, TXT и т.д.).

### C. Ошибка в записи (опечатка, лишний пробел, неправильная точка)

* Частая ошибка: `@` vs `domain.`; CNAME на корне (apex) — CNAME нельзя ставить на корневой домен.
* Исправление: проверьте записи, удалите некорректные CNAME на apex; для корня используйте A/AAAA или ALIAS/ANAME у провайдера (если поддерживает).

### D. Использование собственных nameservers — требуются glue records

* Если вы указываете NS вида `ns1.yourdomain.tld` (т.е. собственные NS внутри того же домена), у регистратора нужно создать **glue records / host records** (адреса NS). Без них делегирование ломается.
* Исправление: в панели регистратора — добавить хосты `ns1` → привязать IP, затем назначить эти NS для домена.

### E. DNSSEC неправильно настроен

* Симптом: `SERVFAIL` у публичных резолверов, при том что NS настроены и записи есть.
* Исправление: временно отключите DNSSEC в панели регистратора/зонового провайдера, проверьте работу. Потом включайте с корректными DS-записями.

### F. Proxy / CDN (например Cloudflare)

* Если вы используете Cloudflare и «оранжевый облачок», внешние проверки могут вести себя иначе. Но обычно записи видны. Убедитесь, что домен добавлен в Cloudflare и что NS на Cloudflare назначены у регистратора.

### G. TTL / кеши

* Иногда старые NS/записи ещё кэшируются в резолверах. (Не даю оценок времени; если вы внесли правки — обязательно проверьте у публичного резолвера и у авторитативного NS напрямую.)

---

# 4. Проверки со стороны регистратора / провайдера — что исправить в настройках

1. В панели регистратора:

   * Убедиться, что **nameservers** выставлены правильно (точно такие, какие дал DNS-провайдер).
   * Если используются собственные NS (ns1.yourdomain), создать **glue** — IP для ns1/ns2.
   * Проверить, что домен **активен**, не истёк и не заблокирован (locked, clienthold).

2. В панели DNS-провайдера:

   * Убедиться, что **зона** существует и содержит нужные записи.
   * A-запись для корня (`@`) присутствует (если хотите, чтобы `yourdomain.tld` резолвился).
   * Нет запрещающих правил (например, зона приватная/ограничена по IP).

3. Если DNSSEC включён — проверьте DS в регистраторе и записи DNSKEY/DS совпадают.

---

# 5. Что делать прямо сейчас — пошагово (практическое руководство)

1. Выполните `dig NS yourdomain.tld +short`. Если получаете пусто — зайдите к регистратору и назначьте NS.
2. Если NS есть — скопируйте один из них и выполните `dig @ns.name yourdomain.tld A +short`.

   * Если ответ пуст — убедитесь, что в панели DNS поставлена A-запись или зона создана.
3. Выполните `dig @8.8.8.8 yourdomain.tld A +short` — если пусто, а авторитативный NS возвращает IP, сообщите это хостеру; если и авторитативный пуст — настраивайте зону.
4. Если получаете `SERVFAIL` при запросе у публичного резолвера, попробуйте запросить `dig +dnssec` и проверить DNSSEC — возможно, нужно отключить DNSSEC, пока не исправлена конфигурация.
5. Если вы используете Cloudflare или другой CDN, убедитесь, что домен **активирован** в их панели и NS у регистратора заменены на их NS.

---

# 6. Полезные команды для сброса/проверки на клиенте

* Очистить локальный кеш DNS:

  * Windows: `ipconfig /flushdns`
  * macOS: `sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder`
  * Linux (systemd-resolved): `sudo systemd-resolve --flush-caches` или `sudo /etc/init.d/nscd restart` (в зависимости от системы)
* Проверить внешний резолвер: `dig @1.1.1.1 yourdomain.tld A +short` (Cloudflare) / `@8.8.8.8` (Google).

---

# 7. Сообщение в поддержку (шаблон), если вы уже перепробовали всё

> Уважаемая поддержка,
> я настроил DNS для домена `yourdomain.tld`, однако публичные резолверы не видят запись A/CNAME/NS.
> Результаты `dig`:
>
> * `dig NS yourdomain.tld +short` → (вставьте ответ)
> * `dig @<authoritative_ns> yourdomain.tld A +short` → (вставьте ответ)
> * `dig @8.8.8.8 yourdomain.tld A +short` → (вставьте ответ)
>   Прошу проверить: правильно ли домен делегирован у регистратора и нет ли проблем с glue/DNSSEC на вашей стороне. Спасибо.

---

# 8. Если хотите — я проверю сам

Если вы вставите сюда (скопируйте в ответ):

* сам домен (например `example.com`) и
* выводы команд: `dig NS domain +short` и `dig @8.8.8.8 domain A +short` (или просто `dig +trace domain`),

— я быстро проанализирую вывод и скажу точную причину и точные правки, которые нужно сделать в панели регистратора/DNS-провайдера.

---

Если хотите — вставьте имя домена и, если есть, вывод `dig +trace <domain>` — разберу немедленно и дам точный план исправления (какая запись, где именно надо поправить).
